# IPTV 시청 로그 데이터 정제 및 편집규칙 타당성 검증 연구
> **대용량 IPTV 시청 로그의 신뢰성 확보를 위한 데이터 전처리 및 로직 최적화**

본 프로젝트는 KT IPTV 가입자의 시청 로그를 시청률 지표로 환산하기 전, 데이터의 정확성을 확보하기 위해 적용되는 편집규칙의 타당성을 검증하고 개선안을 도출하고자 진행되었습니다. 수집 과정에서 발생하는 기계적 노이즈와 비정상 로그를 식별하는 로직을 고도화하여, 실제 시청 행태에 가장 근접한 데이터를 산출하는 파이프라인을 구축하고자 했습니다.

---

<br>

## 1. 프로젝트 개요
* **분석 대상**: KT IPTV 가입자 셋톱박스 수집 시청 로그
* **핵심 분석**:
    - **이상 로그 식별**: 비정상 종료 및 동일 채널 장기 시청 등 '허수 로그' 판별 로직 검증
    - **로직 정합성 개선**: 이틀에 걸친 시청 내역 분리 시 발생하는 시청 시간 왜곡 문제 해결
    - **프로세스 최적화**: 편집규칙 적용 단계 변경을 통한 데이터 신뢰도 제고

<br>

## 2. 사용 데이터 및 기술 스택
* **사용 데이터 (Data)**: 
    - **시청 로그 데이터**: 셋톱박스에서 수집된 실시간 채널 시청 기록
* **기술 스택 (Tech Stack)**:
    - **Language**: `R`
    - **Library**: 
        - **Analysis**: `dplyr`, `lubridate`, `readxl`
        - **Visualization**: `ggplot2` (Gantt Chart 구현)

<br>

## 3. 주요 분석 프로세스
### 1) 데이터 전처리 및 분석
- **Unix Time 변환**: 로그의 선후 관계 및 시청 시간($gap$) 계산을 위해 시각 데이터를 수치형 데이터로 변환
- **이상 로그 제거**: 시청 시작 시간이 종료 시간보다 늦게 기록된($startdate > currentdate$) 기계적 오류 데이터 필터링
- **로그 묶음 처리**: 동일 세션 내 발생하는 중간 로그를 통합하여 단일 시청(시작~최종 종료) 형태로 구조화

### 2) 편집규칙 고도화 로직 (Logic Optimization)
- **비정상 종료 보정**: 종료 시점이 누락된 로그($x \times 1800 + 10$초 패턴)를 감지하여 후속 로그 발생 시점에 맞춰 종료 시간 정밀 보정
- **연속 시청 제한**: 셋톱박스만 켜진 상태를 배제하기 위해 동일 채널 4시간 이상 연속 시청 시 보정 처리
- **로직 순서 최적화**: '날짜 분리' 후 '4시간 보정'을 하던 기존 방식에서, **'4시간 보정' 후 '날짜 분리'**로 순서를 변경하여 데이터 왜곡 해결

<br>

## 4. 핵심 인사이트 (데이터 정합성 중심)
- **로직 선후 관계의 중요성**: 편집규칙의 적용 순서 변경만으로도 이틀에 걸친 장기 시청 데이터에서 발생하던 시청 시간 과다 계상 오류를 해결함
- **비정상 로그의 패턴화**: 비정상 종료 로그가 특정 시간 간격($1800$초 등)으로 발생함을 데이터로 증명하여 보정 로직의 객관적 근거 확보
- **시각화 기반 검증**: ID별 간트 차트(Gantt Chart)를 생성하여 원천 데이터가 가공 단계(ODS→DW→MART→NEW)를 거치며 정제되는 과정을 직관적으로 비교

<br>

## 5. 분석 결과 시각화
| ID별 시청 로그 단계별 비교 (Gantt) | 편집규칙 적용 전/후 시청 시간 차이 |
| :---: | :---: |
| <img src="이미지_주소_1" width="500" /> | <img src="이미지_주소_2" width="400" /> |
| *ODS→DW→MART→NEW 단계별 정제 과정* | *제안 규칙 적용 시 과다 계상된 시청 시간 보정 결과* |

<br>

## 6. 프로젝트 성과 및 기대효과
- **데이터 신뢰도 향상**: 기존 편집규칙의 한계점을 보완하는 개선 로직 제안을 통해 시청 지표의 정확성 제고
- **도메인 지식 결합**: IPTV 산업 특성(셋톱 수집 환경)을 이해하고 이를 데이터 엔지니어링 관점에서 해결하는 역량 증명
- **품질 검증 프로세스 확립**: 대용량 로그 분석 시 발생할 수 있는 예외 케이스를 시나리오별로 정의하고 시각화로 입증하는 분석 프로세스 완수

---
**상세 코드 및 로직은 `편집규칙 및 시각화.R` 파일에서 확인하실 수 있습니다.**
